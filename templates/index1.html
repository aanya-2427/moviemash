<!DOCTYPE html>
<html lang="en">
<head>
	<title>Login V5</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<!--===============================================================================================-->	
	<link rel="icon" type="image/png" href="static/Login_v5/images/icons/favicon.ico"/>
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="static/Login_v5/vendor/bootstrap/css/bootstrap.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="static/Login_v5/fonts/font-awesome-4.7.0/css/font-awesome.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="static/Login_v5/fonts/Linearicons-Free-v1.0.0/icon-font.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="static/Login_v5/vendor/animate/animate.css">
<!--===============================================================================================-->	
	<link rel="stylesheet" type="text/css" href="static/Login_v5/vendor/css-hamburgers/hamburgers.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="static/Login_v5/vendor/animsition/css/animsition.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="static/Login_v5/vendor/select2/select2.min.css">
<!--===============================================================================================-->	
	<link rel="stylesheet" type="text/css" href="static/Login_v5/vendor/daterangepicker/daterangepicker.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="static/Login_v5/css/util.css">
	<link rel="stylesheet" type="text/css" href="static/Login_v5/css/main.css">
<!--===============================================================================================-->
</head>
<body>
	<div class="section" style="background-color:#30302d;">
		<div class="container">
			<div class="row full-height justify-content-center">
				<div class="col-12 text-center align-self-center py-5">
					<div class="section pb-5 pt-5 pt-sm-2 text-center">
						<h6 class="mb-0 pb-3 text-light"><span>Log In </span><span>Sign Up</span></h6>
						<input class="checkbox" type="checkbox" id="reg-log" name="reg-log" />
						<label for="reg-log"></label>
						<div class="card-3d-wrap mx-auto">
							<div class="card-3d-wrapper">

								<!--LOG IN-->
								<div class="card-front">
									<div class="center-wrap">
										<div class="section text-center">
											<h4 class="mb-4 pb-3 text-light">Log In</h4>
											<div class="form-group">
												<form action="http://localhost:5000/validate" method="post">
												<input type="email" name="logemail" class="form-style" placeholder="Your Email" id="logemail" autocomplete="off">
												<i class="input-icon uil uil-at"></i>
											</div>
											<div class="form-group mt-2">
												<input type="password" name="logpass" class="form-style" placeholder="Your Password" id="logpass" autocomplete="off">
												<i class="input-icon uil uil-lock-alt"></i></form>
											</div>
											 
											<input type="submit" value="Submit" class="btn mt-4" id="logIn">

											<p class="mb-0 mt-4 text-center"><a href="#0" class="link">Forgot your password?</a></p>
										</div>
									</div>
								</div>

								<!--SIGN UP-->
								<div class="card-back">
									<div class="center-wrap">
										<div class="section text-center">
											<h4 class="mb-4 pb-3 text-light">Sign Up</h4>
											<div class="form-group">
												<input type="text" name="logname" class="form-style" placeholder="Your Full Name" id="signname" autocomplete="off">
												<i class="input-icon uil uil-user"></i>
											</div>
											<div class="form-group mt-2">
												<input type="email" name="logemail" class="form-style" placeholder="Your Email" id="signemail" autocomplete="off">
												<i class="input-icon uil uil-at"></i>
											</div>
											<div class="form-group mt-2">
												<input type="password" name="logpass" class="form-style" placeholder="Your Password" id="signpass" autocomplete="off">
												<i class="input-icon uil uil-lock-alt"></i>
											</div>
											<a href="#" class="btn mt-4" id="signUp">submit</a>
									</div>
								</div>
							</div>
						</div>
						
					</div>
				</div>
		<a href="#" class="btn-face m-b-20   mx-auto" >
			<i class="fa fa-facebook-official"></i>
			Facebook
		</a>

		<a class="btn-google m-b-20 mx-auto " id='googleLogin' >
			<img src="static/Login_v5/images/icons/icon-google.png" alt="GOOGLE">
			Google
		</a>
	</div></div>
	</div>
	

	
	
<!--===============================================================================================-->
	<script src="static/Login_v5/vendor/jquery/jquery-3.2.1.min.js"></script>
<!--===============================================================================================-->
	<script src="static/Login_v5/vendor/animsition/js/animsition.min.js"></script>
<!--===============================================================================================-->
	<script src="static/Login_v5/vendor/bootstrap/js/popper.js"></script>
	<script src="static/Login_v5/vendor/bootstrap/js/bootstrap.min.js"></script>
<!--===============================================================================================-->
	<script src="static/Login_v5/vendor/select2/select2.min.js"></script>
<!--===============================================================================================-->
	<script src="static/Login_v5/vendor/daterangepicker/moment.min.js"></script>
	<script src="static/Login_v5/vendor/daterangepicker/daterangepicker.js"></script>
<!--===============================================================================================-->
	<script src="static/Login_v5/vendor/countdowntime/countdowntime.js"></script>
<!--===============================================================================================-->
	<script src="static/Login_v5/js/main.js"></script>

</body>

<script type="module">
	// Import the functions you need from the SDKs you need
	import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-app.js";
	import { getDatabase, set, ref, update } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-database.js";
	import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged} from "https://www.gstatic.com/firebasejs/9.8.1/firebase-auth.js";
	import { signInWithRedirect, getRedirectResult } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-auth.js";
	import { GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-auth.js";

	// TODO: Add SDKs for Firebase products that you want to use
	// https://firebase.google.com/docs/web/setup#available-libraries
  
	// Your web app's Firebase configuration
	const firebaseConfig = {
	  apiKey: "AIzaSyAzzh6xguG6eaRABCkNIARO_tbD_7Mw6ko",
	  authDomain: "auth-60ba0.firebaseapp.com",
	  projectId: "auth-60ba0",
	  storageBucket: "auth-60ba0.appspot.com",
	  messagingSenderId: "182509176551",
	  appId: "1:182509176551:web:124bd79f71f85b72cfc442"
	};
  
	// Initialize Firebase
	const app = initializeApp(firebaseConfig);
	const database = getDatabase(app);
	const auth = getAuth(app);
	const provider = new GoogleAuthProvider(app);

	signUp.addEventListener('click', (e)=> {

		var email = document.getElementById('signemail').value;
		var password = document.getElementById('signpass').value;
		var username = document.getElementById('signname').value;

		createUserWithEmailAndPassword(auth, email, password)
   			.then((userCredential) => {
    		// Signed in 
    		const user = userCredential.user;

			set(ref(database, 'users/' + user.uid), {
				username: username,
				email: email
			})
    		// ...
			alert('User created!!');          // Redirect to another page here
  	})
  	.catch((error) => {
    const errorCode = error.code;
    const errorMessage = error.message;
    // ..
	alert(errorMessage);
  });
	});


	logIn.addEventListener('click', (e) => {
		
		var email = document.getElementById('logemail').value;
		var password = document.getElementById('logpass').value;

		signInWithEmailAndPassword(auth, email, password)
  			.then((userCredential) => {
    		// Signed in 
    		const user = userCredential.user;
    		// ...
			const dt = new Date();
			update(ref(database, 'users/' + user.uid), {
				last_login: dt,
			});
			alert('User logged in');
			window.location = 'land';
			//firebase.auth().onAuthStateChanged(user => {
  			if(user) {
    			 //After successful login, user will be redirected to home.html
  			}
			//});
  		})
  		.catch((error) => {
    		const errorCode = error.code;
    		const errorMessage = error.message;

			alert(errorMessage);
  		});
	});
	

	const user = auth.currentUser;
	onAuthStateChanged(auth, (user) => {				// Logout and then login
  if (user) {
    // User is signed in, see docs for a list of available properties
    // https://firebase.google.com/docs/reference/js/firebase.User
    const uid = user.uid;
	//window.location = 'land';
    // ...
  } else {
    // User is signed out
    // ...
  }
});

	
  </script>
</html>
